---
import Layout from '../../../components/Layout.astro';
import UpdateCard from '../../../components/UpdateCard.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const updates = await getCollection('updates');
  const categories = [...new Set(updates.map((u) => u.data.category))];
  return categories.map((category) => ({
    params: { category },
    props: { category },
  }));
}
96
const { category } = Astro.props;

// human-readable category name
const categoryTitles = {
  'plasma-hardware': 'Plasma Hardware & Design',
  'saltwater-dynamics': 'Saltwater & Plasma Dynamics',
  'reactive-species': 'Reactive Species in Saltwater',
};
const title = categoryTitles[category] ?? category;  // ✅ now defined

const all = await getCollection('updates');
const updates = all
  .filter((u) => u.data.category === category)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---



<Layout title={`${title} — Workspace by Ali`} description={`All updates in ${title}.`}>
  <div class="container">
    <header class="page-header">
      <nav class="breadcrumb" aria-label="Breadcrumb">
        <a href="/">Workspace</a>
        <span aria-hidden="true">/</span>
        <span aria-current="page">{title}</span>
      </nav>

      <h1>{title}</h1>
      <p class="subtitle">
        {updates.length} update{updates.length !== 1 ? 's' : ''} in this category.
      </p>
    </header>

    {updates.length === 0 ? (
      <div class="empty-state" role="status" aria-live="polite">
        <p>No updates yet for this category.</p>
      </div>
    ) : (
      <section class="grid" aria-label="Updates list">
        {updates.map((u) => (
          <UpdateCard
            title={u.data.title}
            date={u.data.date}
            summary={u.data.summary}
            category={u.data.category}
            slug={u.slug}
            status={u.data.status}
          />
        ))}
      </section>
    )}
  </div>
</Layout>

<style>
  .page-header { margin-bottom: 2.5rem; }
  .breadcrumb{
    display:flex; gap:.6rem; align-items:center; margin-bottom:1rem;
    font-size:.9rem; color:#666;
  }
  .breadcrumb a{ color:#888; text-decoration:none; }
  .breadcrumb a:hover{ color: var(--brand, #4a9eff); }

  h1{
    margin:0 0 .5rem; font-size:2.2rem; font-weight:700; color:var(--text-1, #fff);
    letter-spacing:-.02em;
  }
  .subtitle{ margin:0; color:var(--text-4, #888); }

  .grid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap:1.25rem;
  }

  .empty-state{ text-align:center; padding:4rem 1rem; color:var(--muted, #555); }
</style>
